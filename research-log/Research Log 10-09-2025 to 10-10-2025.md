### The Focus for these Two Days

Ensure the successful execution of the 100k-element mock lens generation batch job on the Amarel cluster while concurrently building foundational expertise in Keras to prepare for the machine learning phase of the project. This involves actively monitoring the job's status and resource consumption via SLURM commands and real-time log inspection, while systematically studying Keras from environment setup and core syntax to model architecture design principles and the end-to-end workflow for building and training neural networks. 
***
### What I was able to accomplish

- **Amarel Cluster Job:** Resubmitted the previous batch job which failed as a result of using more time than I had allotted. Began monitoring the 100k-element mock lens generation batch job. Researched how to make the batch job more efficient and am currently trying to figure out a way to implement parallel processing for the code in the case the next batch job fails.
    
- **Keras Foundation:** Established a local Keras/TensorFlow environment and progressed through the initial stages of the machine learning workflow:
    
    - Understood the core components of a `Sequential` model.
        
    - Researched and implemented data preparation techniques using `numpy` and `sklearn`, specifically focusing on converting data to arrays, shuffling, and normalization with `MinMaxScaler`.
        
    - Successfully coded the initial setup for a simple Sequential model, including imports for `Sequential`, `Dense`, `Activation`, and the `Adam` optimizer.
***
### Results

- The mock lens generation job is running on Amarel. Initial log inspection indicates it is proceeding without errors.

- Worked on developing a Keras model for sequential data and worked on data preparation & transformation in order to learn how the model matches the sizes of the datasets and uses it within its hidden layers. The data formatting is quite specific which is required for the `.fit()` function. Therefore, I worked on researching how I can actively used a 2D dataset (like mine) and flatten it such that it can serve as an input for the ML model without changing the key characteristic of the dataset. 
***
### Challenges & Pause Points

- The primary challenge encountered was a **conceptual gap in adapting the Keras Sequential model to my specific dataset structure.** My initial data preparation (creating `x` and `y` from dictionary keys/values) was correct for a simple numerical regression/classification problem. However, I paused when I realized my actual dataset for this research is more complex. The input `x` is not a single number but an array, and the output `y` is also an array likely containing text (e.g., multiple labels like redshift, image position, etc). The simple `Dense` layer example I started with assumes a flat input, not the multi-dimensional arrays I will be working with. Therefore, I am reconsidering using a sequential model and instead using a different model. I might need to ask Somayeh for help regarding this matter.

- The above "pause point" additionally has raised questions about the correct model architecture that I can use (e.g., using `Conv2D` layers for images, `Flatten` layers) and how to properly structure the input and output layers to handle this complexity.
***
### Questions & Ideas

- **Key Question:** How do I structure a Keras model when the input data is a multi-dimensional array (e.g., a 2D image of a lens) and the output is a set of multiple physical parameters?

- **Follow-up Questions:**
    
    - Does the `Sequential` API remain the best choice for this, or should I plan to use the Functional API for multi-input/multi-output models?
        
    - How do I specify the `input_shape` parameter for the first layer when my input is a 2D image?
        
    - For the final layer, how do I configure a `Dense` layer to predict, for example, three different parameters simultaneously? 

- The next phase of study should focus on Convolutional Neural Networks (CNNs) for image input and multi-output regression models. The Functional API might be necessary for the final model. Note that I should consult Somayeh for more help regarding this matter as she's more experienced with Machine Learning.
***
### Next Steps

1. **Deepen Keras Architecture Knowledge:** Shift focus from simple `Dense` networks to studying CNN architectures and the Functional API in Keras to handle image-like input and multi-parameter output.
    
2. **Design a Model Prototype:** Sketch out the architecture for a CNN that takes a 2D array (mock lens image) as input and outputs a vector of predicted parameters.
    
3. **Formalize Data Pipeline:** Plan how to load the 100k generated mock lenses from file into a data pipeline that can be fed into a Keras model.
    
4. **Continue Cluster Monitoring:** Keep monitoring the Amarel job to completion (note that I allocated 48 hours to this batch job this time, therefore, I will have to check how the batch job is running the following Monday).
##### Tags: #Keras #SequentialModel #DataPreprocessing #Amarel #SLURM




